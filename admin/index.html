<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Clower Edit ¬∑ Admin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/assets/css/tailwind.css" />
  <script type="module" src="./main.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body x-data="adminApp" x-init="init()" :class="{'overflow-hidden': preview.modalOpen}" class="transition-colors duration-200">
  <div class="sr-only" aria-live="polite" x-text="announcement"></div>
  <div x-show="!ready" class="fixed inset-0 z-50 flex items-center justify-center bg-slate-950/80 backdrop-blur" role="status">
    <div class="flex flex-col items-center gap-3 text-sm font-medium text-slate-200">
      <svg class="h-6 w-6 animate-spin text-indigo-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M12 3v3m0 12v3m9-9h-3M6 12H3m15.364-6.364-2.121 2.121M9.757 14.243 7.636 16.364m8.485 0-2.121-2.121M9.757 9.757 7.636 7.636" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
      <span>Initialisation de l‚Äôinterface‚Ä¶</span>
    </div>
  </div>

  <template x-if="view === 'login' && ready">
    <div class="relative min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-800">
      <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(99,102,241,0.24),_transparent_55%)]"></div>
      <div class="relative z-10 flex min-h-screen items-center justify-center px-4 py-16">
        <form class="w-full max-w-lg rounded-3xl border border-white/10 bg-white/5 p-10 text-slate-100 shadow-2xl backdrop-blur" @submit.prevent="submitLogin" aria-labelledby="login-title">
          <div class="mb-8 space-y-3">
            <span class="inline-flex items-center gap-2 rounded-full bg-indigo-500/15 px-4 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-indigo-400">Clower Edit</span>
            <h1 id="login-title" class="font-display text-3xl font-semibold text-white">Connexion</h1>
            <p class="text-sm text-slate-300">Choisissez un site et identifiez-vous pour acc√©der au studio d‚Äô√©dition.</p>
          </div>
          <div class="grid gap-6">
            <label class="space-y-2 text-sm">
              <span class="font-semibold uppercase tracking-wider text-slate-300">Site</span>
              <div class="relative">
                <select class="w-full appearance-none rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-white focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500" x-model="siteId" @change="switchSite($event.target.value)">
                  <template x-for="site in sites" :key="site">
                    <option class="bg-slate-950 text-slate-200" :value="site" x-text="site"></option>
                  </template>
                </select>
                <svg class="pointer-events-none absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </div>
            </label>
            <label class="space-y-2 text-sm">
              <span class="font-semibold uppercase tracking-wider text-slate-300">Identifiant</span>
              <input type="text" class="w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-white placeholder:text-slate-500 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500" x-model="login.username" autocomplete="username" />
            </label>
            <label class="space-y-2 text-sm">
              <span class="font-semibold uppercase tracking-wider text-slate-300">Mot de passe</span>
              <input type="password" class="w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-white placeholder:text-slate-500 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500" x-model="login.password" autocomplete="current-password" />
            </label>
            <p class="text-sm text-rose-400" x-text="login.error"></p>
            <button type="submit" class="flex items-center justify-center gap-2 rounded-2xl bg-indigo-500 px-5 py-3 text-sm font-semibold text-white shadow-lg transition duration-150 ease-out hover:scale-[1.02] hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500">
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M5 12h14M12 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              Se connecter
            </button>
          </div>
        </form>
      </div>
    </div>
  </template>

  <template x-if="view !== 'login' && ready">
    <div class="flex h-screen">
      <aside class="custom-scrollbar hidden w-52 flex-shrink-0 flex-col overflow-y-auto border-r border-slate-200/60 bg-white/90 px-5 py-6 text-slate-700 backdrop-blur dark:border-slate-800 dark:bg-slate-950/95 dark:text-slate-200 contrast:border-contrastAccent/40 contrast:bg-black contrast:text-contrastText md:flex" data-surface="sidebar">
        <div class="flex min-h-full flex-col justify-between">
          <div class="space-y-6">
            <div class="space-y-4">
              <div class="flex items-center gap-3">
                <span class="grid h-10 w-10 place-items-center rounded-2xl bg-indigo-500/20 text-indigo-400">
                  <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M4 7h16M4 12h16M4 17h16" stroke-linecap="round" />
                  </svg>
                </span>
                <div>
                  <p class="text-[10px] uppercase tracking-[0.28em] text-slate-500">Clower Edit</p>
                  <p class="font-display text-base font-semibold text-white">Studio</p>
                </div>
              </div>
              <div class="space-y-2">
                <label class="text-[10px] font-semibold uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400 contrast:text-contrastAccent" for="site-select">Site</label>
                <div class="relative">
                  <select id="site-select" class="w-full appearance-none rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:border-indigo-500 focus:outline-none focus-visible:outline-2 focus-visible:outline-indigo-500 dark:border-slate-800 dark:bg-white/10 dark:text-slate-200 contrast:border-contrastAccent/40 contrast:bg-black contrast:text-contrastText" x-model="siteId" @change="switchSite($event.target.value)">
                    <template x-for="site in sites" :key="site">
                      <option class="bg-slate-950 text-slate-200" :value="site" x-text="site"></option>
                    </template>
                  </select>
                  <svg class="pointer-events-none absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </div>
                <button type="button" class="flex items-center gap-2 text-xs font-semibold text-indigo-400 transition hover:text-indigo-300 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 contrast:text-contrastAccent contrast:hover:text-contrastText" @click="createSite">
                  <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M12 5v14m-7-7h14" stroke-linecap="round" />
                  </svg>
                  Nouveau site
                </button>
              </div>
            </div>

            <nav class="space-y-3" aria-label="Navigation principale">
              <div class="rounded-2xl border border-white/10 bg-white/5 dark:border-slate-800 dark:bg-white/10 contrast:border-contrastAccent/40 contrast:bg-transparent" @click.outside="sidebarPagesOpen = false">
                <button type="button" class="flex w-full items-center justify-between px-4 py-3 text-sm font-semibold text-slate-200 transition hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 contrast:text-contrastText contrast:hover:text-contrastAccent" @click="toggleSidebarPages()" :aria-expanded="sidebarPagesOpen.toString()">
                  <span class="flex items-center gap-2">
                    <span class="grid h-8 w-8 place-items-center rounded-xl bg-white/10 text-indigo-400" x-html="pagesNav.icon"></span>
                    <span x-text="pagesNav.label"></span>
                  </span>
                  <svg class="h-4 w-4 text-slate-400 transition contrast:text-contrastAccent" :class="sidebarPagesOpen ? 'rotate-180' : ''" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
                <div x-show="sidebarPagesOpen" x-transition.opacity class="space-y-1 border-t border-white/10 px-3 py-3 text-sm dark:border-slate-800 contrast:border-contrastAccent/30 contrast:text-contrastText">
                  <template x-for="page in pages" :key="page.slug">
                    <button type="button" class="flex w-full items-center justify-between rounded-xl px-3 py-2 text-left transition hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 contrast:hover:bg-contrastAccent/10" :class="currentPage?.slug === page.slug ? 'bg-indigo-500/15 text-white contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'text-slate-300 contrast:text-contrastText'" @click="openPageFromSidebar(page.slug)">
                      <span class="truncate" x-text="page.title"></span>
                      <span class="text-[11px] text-slate-500 contrast:text-contrastAccent/80" x-text="page.slug"></span>
                    </button>
                  </template>
                  <button type="button" class="mt-2 flex w-full items-center gap-2 rounded-xl border border-dashed border-white/20 px-3 py-2 text-left text-xs font-semibold text-indigo-300 transition hover:border-indigo-400 hover:text-indigo-200 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 contrast:border-contrastAccent/60 contrast:text-contrastAccent contrast:hover:text-contrastText" @click="createPageFromSidebar()">
                    <span>+ Nouvelle page</span>
                  </button>
                </div>
              </div>

              <div class="space-y-1">
                <template x-for="item in navigationSimple" :key="item.id">
                  <button type="button" class="flex w-full items-center justify-between rounded-2xl px-4 py-2 text-sm transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 contrast:hover:bg-contrastAccent/10" :class="view === item.id ? 'bg-indigo-500/15 text-white shadow-lg contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'text-slate-300 hover:bg-white/5 hover:text-white contrast:text-contrastText'" @click="setView(item.id)">
                    <span class="flex items-center gap-2">
                      <span class="grid h-8 w-8 place-items-center rounded-xl bg-white/5 text-indigo-400 dark:bg-white/10 contrast:bg-transparent contrast:text-contrastAccent" :class="view === item.id ? 'bg-indigo-500/20 text-indigo-300 contrast:bg-contrastAccent/20 contrast:text-contrastText' : ''" x-html="item.icon"></span>
                      <span x-text="item.label"></span>
                    </span>
                  </button>
                </template>
              </div>
            </nav>
          </div>

          <div class="space-y-4 border-t border-white/10 pt-4 text-[11px] text-slate-500 dark:border-slate-800 dark:text-slate-400 contrast:border-contrastAccent/40 contrast:text-contrastText/80">
            <div>
              <p class="font-semibold uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400 contrast:text-contrastAccent">Apparence</p>
              <div class="mt-2 flex items-center gap-2">
                <template x-for="mode in themeModes" :key="mode.id">
                  <button type="button" class="flex h-9 w-9 items-center justify-center rounded-xl border border-white/10 text-slate-200 transition hover:-translate-y-0.5 hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 contrast:border-contrastAccent/60 contrast:text-contrastText contrast:hover:bg-contrastAccent/10" :class="$store.theme.mode === mode.id ? 'border-indigo-500 bg-indigo-500/20 text-white shadow-lg contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : ''" @click="$store.theme.set(mode.id)">
                    <span class="text-base" x-text="mode.icon"></span>
                  </button>
                </template>
              </div>
            </div>
            <button type="button" class="flex items-center gap-2 text-xs font-semibold text-slate-400 transition hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 contrast:text-contrastText contrast:hover:text-contrastAccent" @click="logout">
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M15 3h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-2" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M10 17l5-5-5-5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M15 12H3" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              D√©connexion
            </button>
          </div>
        </div>
      </aside>

      <div class="flex h-full flex-1 flex-col bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-100 contrast:bg-black contrast:text-contrastText">
        <header class="sticky top-0 z-30 border-b border-slate-200/70 bg-white/85 px-6 py-5 backdrop-blur-md dark:border-slate-800 dark:bg-slate-950/85 contrast:border-contrastAccent/40 contrast:bg-black/95" data-surface="workspace-header">
          <template x-if="view === 'pages'">
            <div class="flex flex-col gap-5 lg:flex-row lg:items-start lg:justify-between lg:px-4">
              <div class="space-y-1">
                <p class="text-xs uppercase tracking-[0.28em] text-slate-500 dark:text-slate-400 contrast:text-contrastAccent">Page active</p>
                <h1 class="font-display text-2xl font-semibold text-slate-900 dark:text-white contrast:text-contrastAccent" x-text="currentPage ? currentPage.title : 'S√©lectionnez une page'"></h1>
                <p class="text-sm text-slate-500 dark:text-slate-400 contrast:text-contrastAccent/80" x-text="currentPage ? `/${currentPage.slug}` : 'Choisissez une page dans la navigation pour commencer.'"></p>
              </div>
              <div class="flex flex-col items-start gap-3 lg:items-end">
                <div class="flex flex-wrap items-center gap-2">
                  <div x-show="autoSave.visible" x-transition.opacity class="flex items-center gap-2 rounded-full px-3 py-1 text-xs font-medium" :class="autoSave.status === 'saving' ? 'bg-slate-200 text-slate-600 dark:bg-slate-800 dark:text-slate-200 contrast:bg-contrastAccent/10 contrast:text-contrastAccent' : autoSave.status === 'saved' ? 'bg-emerald-100 text-emerald-700 dark:bg-emerald-500/20 dark:text-emerald-100 contrast:bg-contrastAccent/20 contrast:text-contrastText' : autoSave.status === 'error' ? 'bg-rose-100 text-rose-600 dark:bg-rose-500/20 dark:text-rose-100 contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-200 contrast:bg-contrastAccent/10 contrast:text-contrastAccent'">
                    <span aria-hidden="true" x-text="autoSave.status === 'saving' ? '‚è≥' : autoSave.status === 'error' ? '‚ö†Ô∏è' : 'üíæ'"></span>
                    <span x-text="autoSave.message"></span>
                  </div>
                  <button type="button" class="flex h-10 w-10 items-center justify-center rounded-xl border border-slate-200 bg-white text-base text-slate-600 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" @click="$store.ui.togglePreview()" :aria-pressed="$store.ui.showPreview.toString()" :title="$store.ui.showPreview ? 'Masquer la mini preview' : 'Afficher la mini preview'">
                    <span aria-hidden="true">üëÅÔ∏è</span>
                  </button>
                  <button type="button" class="flex h-10 w-10 items-center justify-center rounded-xl border border-slate-200 bg-white text-base text-slate-600 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" @click="$store.ui.toggleToolkit()" :aria-pressed="$store.ui.showToolkit.toString()" :title="$store.ui.showToolkit ? 'Replier la colonne studio' : 'Afficher la colonne studio'">
                    <span aria-hidden="true">üß©</span>
                  </button>
                  <div x-data="{ open: false }" x-show="!!currentPage" class="relative">
                    <button type="button" class="flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-100 dark:hover:border-indigo-400 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" @click="open = !open">
                      <span>+ Section</span>
                      <svg class="h-4 w-4 transition" :class="open ? 'rotate-180' : ''" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round" />
                      </svg>
                    </button>
                    <div x-cloak x-show="open" x-transition.opacity class="absolute right-0 z-20 mt-2 w-48 space-y-1 rounded-2xl border border-slate-200 bg-white p-2 shadow-xl dark:border-slate-700 dark:bg-slate-900 contrast:border-contrastAccent/60 contrast:bg-black" @click.outside="open = false">
                      <button type="button" class="flex w-full items-center rounded-xl px-3 py-2 text-left text-sm text-slate-600 transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:text-slate-200 dark:hover:bg-white/10 contrast:text-contrastText contrast:hover:bg-contrastAccent/15" @click="addSection('hero'); open = false">Section hero</button>
                      <button type="button" class="flex w-full items-center rounded-xl px-3 py-2 text-left text-sm text-slate-600 transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:text-slate-200 dark:hover:bg-white/10 contrast:text-contrastText contrast:hover:bg-contrastAccent/15" @click="addSection('text'); open = false">Bloc texte</button>
                      <button type="button" class="flex w-full items-center rounded-xl px-3 py-2 text-left text-sm text-slate-600 transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:text-slate-200 dark:hover:bg-white/10 contrast:text-contrastText contrast:hover:bg-contrastAccent/15" @click="addSection('image'); open = false">Bloc image</button>
                    </div>
                  </div>
                  <button type="button" class="rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-100 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" x-show="!!currentPage" @click="savePage">Sauvegarder</button>
                  <button type="button" class="flex items-center gap-2 rounded-xl bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow-lg transition hover:-translate-y-0.5 hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="openPreview">
                    <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M2.5 12s3.5-7 9.5-7 9.5 7 9.5 7-3.5 7-9.5 7S2.5 12 2.5 12Z" stroke-linecap="round" stroke-linejoin="round" />
                      <circle cx="12" cy="12" r="2.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Pr√©visualiser
                  </button>
                </div>
                <div x-show="currentPage" x-transition.opacity class="flex items-center gap-1 rounded-full border border-slate-200 bg-white/90 p-1 text-xs font-semibold text-slate-600 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText">
                  <button type="button" class="rounded-full px-3 py-1 transition" :class="pageTab === 'content' ? 'bg-indigo-500 text-white shadow-sm contrast:bg-contrastAccent contrast:text-contrastText' : 'hover:bg-slate-100 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15'" @click="setPageTab('content')">Contenu</button>
                  <button type="button" class="rounded-full px-3 py-1 transition" :class="pageTab === 'seo' ? 'bg-indigo-500 text-white shadow-sm contrast:bg-contrastAccent contrast:text-contrastText' : 'hover:bg-slate-100 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15'" @click="setPageTab('seo')">SEO</button>
                </div>
              </div>
            </div>
          </template>
          <template x-if="view !== 'pages'">
            <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between lg:px-4">
              <div class="space-y-1">
                <p class="text-xs uppercase tracking-[0.28em] text-slate-500 dark:text-slate-400 contrast:text-contrastAccent" x-text="`Site ¬∑ ${siteId}`"></p>
                <h1 class="font-display text-2xl font-semibold text-slate-900 dark:text-white contrast:text-contrastAccent" x-text="viewCopy[view]?.title"></h1>
                <p class="text-sm text-slate-500 dark:text-slate-400 contrast:text-contrastAccent/80" x-text="viewCopy[view]?.description"></p>
              </div>
              <div class="flex flex-wrap items-center gap-3">
                <button type="button" class="flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-100 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" @click="refreshData">
                  <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M4 4v6h6M20 20v-6h-6M20 9A8 8 0 0 0 5.64 5.64L4 10M4 15a8 8 0 0 0 14.36 3.36L20 14" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  Actualiser
                </button>
                <button type="button" class="flex items-center gap-2 rounded-xl bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow-lg transition hover:-translate-y-0.5 hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="openPreview">
                  <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M2.5 12s3.5-7 9.5-7 9.5 7 9.5 7-3.5 7-9.5 7S2.5 12 2.5 12Z" stroke-linecap="round" stroke-linejoin="round" />
                    <circle cx="12" cy="12" r="2.5" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                  Pr√©visualiser
                </button>
              </div>
            </div>
          </template>
        </header>

        <div class="flex flex-1 min-h-0 flex-col overflow-hidden lg:flex-row">
          <main class="custom-scrollbar flex-1 min-h-0 max-h-screen overflow-y-auto px-6 py-8 lg:px-12" data-surface="workspace-main">
            <div class="space-y-12">
            <section x-show="view === 'pages'" x-transition.opacity class="relative space-y-6" role="region" aria-live="polite">
          <template x-if="!currentPage">
            <div class="rounded-3xl border border-dashed border-slate-300 bg-white/80 p-10 text-center text-sm text-slate-500 shadow-sm dark:border-slate-700 dark:bg-slate-900/60 dark:text-slate-300 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText">
              S√©lectionnez une page dans la colonne de gauche pour commencer l‚Äô√©dition.
            </div>
          </template>

          <template x-if="currentPage">
            <div class="space-y-6">
              <template x-if="pageTab === 'content'">
                <div class="space-y-6">
                  <template x-for="(section, index) in currentPage.sections" :key="section.id">
                    <article class="space-y-5 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm transition dark:border-slate-800 dark:bg-slate-900/70 dark:shadow-lg/20 contrast:border-contrastAccent/40 contrast:bg-black/85 contrast:shadow-none" :class="layoutPanel.section === section.id ? 'border-indigo-300 shadow-md ring-2 ring-indigo-200/60 dark:border-indigo-500/60 dark:ring-indigo-500/30 contrast:border-contrastAccent contrast:ring-contrastAccent/50' : ''">
                      <div class="flex flex-wrap items-center justify-between gap-3">
                        <button type="button" class="flex items-center gap-3 rounded-xl border border-transparent px-2 py-1 text-left transition hover:border-indigo-200 hover:bg-indigo-50/70 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:hover:border-indigo-500/30 dark:hover:bg-indigo-500/10 contrast:hover:border-contrastAccent/40 contrast:hover:bg-contrastAccent/10" @click="selectLayoutSection(section.id)">
                          <span class="grid h-10 w-10 place-items-center rounded-xl bg-indigo-500/15 text-xs font-semibold uppercase tracking-[0.18em] text-indigo-500 dark:text-indigo-300 contrast:bg-contrastAccent/20 contrast:text-contrastText" x-text="section.type"></span>
                          <div class="min-w-0">
                            <p class="text-[11px] uppercase tracking-[0.2em] text-slate-400 dark:text-slate-500 contrast:text-contrastAccent/70">Bloc</p>
                            <p class="font-medium text-slate-700 dark:text-slate-100 contrast:text-contrastText" x-text="sectionLabels[section.type] || section.type"></p>
                          </div>
                        </button>
                        <select class="rounded-xl border border-slate-200 bg-white px-3 py-1.5 text-xs font-medium text-slate-600 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 contrast:border-contrastAccent/40 contrast:bg-black contrast:text-contrastText" x-model="section.preset" @change="updateSectionPreset(section, section.preset)">
                          <template x-for="preset in sectionPresets[section.type]" :key="preset.id">
                            <option class="bg-white text-slate-700 dark:bg-slate-900 dark:text-slate-200 contrast:bg-black contrast:text-contrastText" :value="preset.id" x-text="preset.label"></option>
                          </template>
                        </select>
                        </div>
                        <button type="button" class="rounded-lg border border-rose-300/70 bg-rose-100/60 px-3 py-1.5 text-xs font-semibold text-rose-600 transition hover:-translate-y-0.5 hover:bg-rose-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-400 dark:border-rose-400/40 dark:bg-rose-500/10 dark:text-rose-200 contrast:border-contrastAccent/50 contrast:bg-transparent contrast:text-contrastAccent contrast:hover:bg-contrastAccent/15" @click.stop="removeSection(index)">
                          Retirer
                        </button>
                      </div>

                      <div class="space-y-3" x-show="section.type === 'hero'">
                        <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                          Eyebrow
                          <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="section.props.eyebrow">
                        </label>
                        <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                          Titre
                          <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="section.props.title">
                        </label>
                        <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                          Sous-titre
                          <textarea class="w-full rounded-xl border border-slate-200 bg-white px-3 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" rows="3" x-model="section.props.subtitle"></textarea>
                        </label>
                        <div class="grid gap-3 sm:grid-cols-2">
                          <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                            Bouton
                            <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="section.props.cta">
                          </label>
                          <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                            Lien
                            <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="section.props.ctaLink">
                          </label>
                        </div>
                      </div>

                      <div class="space-y-3" x-show="section.type === 'text'">
                        <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                          Contenu HTML
                          <textarea class="w-full rounded-xl border border-slate-200 bg-white px-3 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" rows="5" x-model="section.props.content"></textarea>
                        </label>
                      </div>

                      <div class="space-y-3" x-show="section.type === 'image'">
                        <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                          Source
                          <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="section.props.src">
                        </label>
                        <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                          Texte alternatif
                          <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="section.props.alt">
                        </label>
                        <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                          L√©gende
                          <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="section.props.caption">
                        </label>
                      </div>

                      <div class="space-y-4" x-show="section.type === 'groupe'">
                        <template x-if="!Array.isArray(section.children) || !section.children.length">
                          <p class="rounded-2xl border border-dashed border-slate-300 bg-white/80 px-4 py-6 text-center text-xs text-slate-500 dark:border-slate-700 dark:bg-slate-900/40 dark:text-slate-400 contrast:border-contrastAccent/50 contrast:bg-black/70 contrast:text-contrastAccent/80">
                            Ajoutez un contenu pour commencer √† structurer ce groupe.
                          </p>
                        </template>
                        <template x-if="Array.isArray(section.children) && section.children.length">
                          <div class="space-y-3">
                            <template x-for="(child, childIndex) in section.children" :key="child.id">
                              <div class="rounded-2xl border border-slate-200 bg-white/85 p-4 transition dark:border-slate-700 dark:bg-slate-900/50 contrast:border-contrastAccent/40 contrast:bg-black/80"
                                draggable="true"
                                @dragstart="startGroupDrag(section.id, childIndex)"
                                @dragend="endGroupDrag()"
                                @dragover.prevent="hoverGroupDrag(section.id, childIndex)"
                                @drop.prevent="dropGroupDrag(section.id, childIndex)"
                                :class="groupDragActive(section.id, childIndex) ? 'border-indigo-400 shadow-sm dark:border-indigo-500/60 contrast:border-contrastAccent/60' : ''">
                                <div class="flex items-center justify-between gap-3">
                                  <div class="flex items-center gap-2">
                                    <span class="cursor-move text-lg" aria-hidden="true">‚ÜïÔ∏è</span>
                                    <div>
                                      <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-400 dark:text-slate-500 contrast:text-contrastAccent/70">Contenu</p>
                                      <p class="text-sm font-medium text-slate-600 dark:text-slate-100 contrast:text-contrastText" x-text="sectionLabels[child.type] || child.type"></p>
                                    </div>
                                  </div>
                                  <button type="button" class="rounded-lg border border-rose-200 bg-rose-100/70 px-3 py-1 text-xs font-semibold text-rose-600 transition hover:-translate-y-0.5 hover:bg-rose-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-400 dark:border-rose-400/50 dark:bg-rose-500/15 dark:text-rose-200 contrast:border-contrastAccent/60 contrast:bg-transparent contrast:text-contrastAccent contrast:hover:bg-contrastAccent/20" @click="removeGroupChild(section.id, childIndex)">
                                    Retirer
                                  </button>
                                </div>
                                <div class="mt-4 space-y-3">
                                  <div class="space-y-3" x-show="child.type === 'hero'">
                                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                      Eyebrow
                                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="child.props.eyebrow">
                                    </label>
                                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                      Titre
                                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="child.props.title">
                                    </label>
                                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                      Sous-titre
                                      <textarea class="w-full rounded-xl border border-slate-200 bg-white px-3 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" rows="3" x-model="child.props.subtitle"></textarea>
                                    </label>
                                    <div class="grid gap-3 sm:grid-cols-2">
                                      <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                        Libell√© CTA
                                        <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="child.props.cta">
                                      </label>
                                      <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                        Lien CTA
                                        <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="child.props.ctaLink">
                                      </label>
                                    </div>
                                  </div>

                                  <div class="space-y-3" x-show="child.type === 'text'">
                                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                      Contenu HTML
                                      <textarea class="w-full rounded-xl border border-slate-200 bg-white px-3 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" rows="4" x-model="child.props.content"></textarea>
                                    </label>
                                  </div>

                                  <div class="space-y-3" x-show="child.type === 'image'">
                                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                      Source
                                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="child.props.src">
                                    </label>
                                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                      Texte alternatif
                                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="child.props.alt">
                                    </label>
                                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                                      L√©gende
                                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="child.props.caption">
                                    </label>
                                  </div>
                                </div>
                              </div>
                            </template>
                            <div class="h-4 rounded-xl border border-dashed border-transparent transition" :class="groupDragActive(section.id, section.children.length) ? 'border-indigo-400 bg-indigo-500/10 dark:border-indigo-500/40 contrast:border-contrastAccent/50 contrast:bg-contrastAccent/15' : ''" @dragover.prevent="hoverGroupDrag(section.id, section.children.length)" @drop.prevent="dropGroupDrag(section.id, section.children.length)"></div>
                          </div>
                        </template>
                        <div class="flex justify-start pt-1">
                          <div class="relative" x-data="{ open: false }">
                            <button type="button" class="flex items-center gap-2 rounded-xl border border-dashed border-slate-300 bg-white px-4 py-2 text-xs font-semibold text-slate-600 transition hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastAccent contrast:hover:text-contrastText" @click="open = !open">
                              + Ajouter un contenu
                            </button>
                            <div x-cloak x-show="open" x-transition.opacity class="absolute z-20 mt-2 w-52 space-y-1 rounded-2xl border border-slate-200 bg-white p-2 text-xs text-slate-600 shadow-xl dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText">
                              <template x-for="item in groupChildTypes" :key="item.id">
                                <button type="button" class="block w-full rounded-xl px-3 py-2 text-left transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15" @click="addGroupChild(section.id, item.id); open = false" x-text="item.label"></button>
                              </template>
                            </div>
                          </div>
                        </div>
                      </div>
                    </article>
                  </template>

                  <div class="flex justify-center">
                    <div class="relative" x-data="{ open: false }">
                      <button type="button" class="flex items-center gap-2 rounded-2xl border border-dashed border-slate-300 bg-white px-5 py-3 text-sm font-semibold text-slate-600 transition hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/70 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastAccent contrast:hover:text-contrastText" @click="open = !open">
                        <span>+ Ajouter une section</span>
                      </button>
                      <div x-cloak x-show="open" x-transition.opacity class="absolute left-1/2 z-20 mt-2 w-48 -translate-x-1/2 space-y-1 rounded-2xl border border-slate-200 bg-white p-2 text-xs text-slate-600 shadow-xl dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText">
                          <button type="button" class="block w-full rounded-xl px-3 py-2 text-left transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15" @click="addSection('hero'); open = false">Section hero</button>
                          <button type="button" class="block w-full rounded-xl px-3 py-2 text-left transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15" @click="addSection('text'); open = false">Bloc texte</button>
                          <button type="button" class="block w-full rounded-xl px-3 py-2 text-left transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15" @click="addSection('image'); open = false">Bloc image</button>
                          <button type="button" class="block w-full rounded-xl px-3 py-2 text-left transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15" @click="addSection('groupe'); open = false">Groupe de contenu</button>
                      </div>
                    </div>
                  </div>
                </div>
              </template>

              <template x-if="pageTab === 'seo'">
                <div class="space-y-5 rounded-3xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-800 dark:bg-slate-900/70 contrast:border-contrastAccent/50 contrast:bg-black/85 contrast:shadow-none">
                  <div class="space-y-3 rounded-2xl border border-slate-200 bg-slate-50 p-5 dark:border-slate-800 dark:bg-slate-900 contrast:border-contrastAccent/40 contrast:bg-black">
                    <p class="text-xs uppercase tracking-[0.18em] text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">Aper√ßu Google</p>
                    <div class="space-y-1 rounded-xl border border-slate-200 bg-white p-4 shadow-inner dark:border-slate-800 dark:bg-slate-900 contrast:border-contrastAccent/40 contrast:bg-black">
                      <p class="text-[15px] font-medium text-slate-800 dark:text-slate-100 contrast:text-contrastText" x-text="pageSeo.title || currentPage?.title || 'Titre de votre page'"></p>
                      <p class="text-[13px] text-emerald-500 dark:text-emerald-300 contrast:text-contrastAccent" x-text="'https://' + (siteSeo.site?.domain || 'clower.site') + '/' + (currentPage?.slug || '')"></p>
                      <p class="text-sm text-slate-600 dark:text-slate-300 contrast:text-contrastText" x-text="pageSeo.description || 'Ajoutez une description engageante pour am√©liorer votre r√©f√©rencement.'"></p>
                    </div>
                  </div>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Titre SEO
                    <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="pageSeo.title">
                  </label>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Description
                    <textarea rows="3" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="pageSeo.description"></textarea>
                  </label>
                  <div class="flex items-center gap-2">
                    <input id="page-indexed" type="checkbox" class="h-4 w-4 rounded border-slate-300 bg-white text-indigo-500 focus:ring-indigo-500 dark:border-slate-600 dark:bg-slate-900 dark:text-indigo-300 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastAccent" x-model="pageSeo.indexed">
                    <label for="page-indexed" class="text-sm text-slate-600 dark:text-slate-300 contrast:text-contrastText">Indexer cette page</label>
                  </div>
                  <button type="button" class="inline-flex items-center gap-2 rounded-xl bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow-lg transition hover:-translate-y-0.5 hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="savePageSeo">
                    Enregistrer le SEO
                  </button>
                </div>
              </template>
            </div>
          </template>
        </section>

            <section x-show="view === 'seo'" x-transition.opacity class="space-y-8" aria-labelledby="seo-global">
              <div class="rounded-3xl border border-white/10 bg-white/5 p-6 shadow-lg">
                <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                  <div>
                    <h2 id="seo-global" class="font-display text-xl font-semibold text-white">SEO global</h2>
                    <p class="text-sm text-slate-400">D√©finissez les m√©tadonn√©es et le menu principal pour tout le site.</p>
                  </div>
                  <button type="button" class="rounded-xl bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow shadow-lg transition hover:-translate-y-0.5 hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="saveSiteSeo">
                    Enregistrer
                  </button>
                </div>

                <div class="mt-6 grid gap-6 lg:grid-cols-[2fr_1fr]">
                  <div class="space-y-5">
                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                      Nom du site
                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="siteSeo.site.name">
                    </label>
                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                      Description
                      <textarea rows="3" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="siteSeo.site.description"></textarea>
                    </label>
                    <div class="grid gap-4 sm:grid-cols-2">
                      <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                        Auteur
                        <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="siteSeo.site.author">
                      </label>
                      <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                        Domaine
                        <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="siteSeo.site.domain">
                      </label>
                    </div>
                  </div>

                  <div class="space-y-3 rounded-2xl border border-white/10 bg-white/5 p-4">
                    <p class="text-xs uppercase tracking-[0.18em] text-slate-500">SERP preview</p>
                    <div class="space-y-1 rounded-xl border border-white/10 bg-white/10 p-4 text-sm text-slate-200">
                      <p class="text-[15px] font-medium text-indigo-100" x-text="siteSeo.site.name || 'Votre site'"></p>
                      <p class="text-xs text-emerald-300" x-text="siteSeo.site.domain || 'www.monsite.fr'"></p>
                      <p x-text="siteSeo.site.description || 'Ajoutez une description pour pr√©senter votre site dans les r√©sultats de recherche.'"></p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="rounded-3xl border border-white/10 bg-white/5 p-6 shadow-lg">
                <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
                  <div>
                    <h3 class="font-display text-lg font-semibold text-white">Navigation principale</h3>
                    <p class="text-sm text-slate-400">R√©organisez l‚Äôordre, contr√¥lez la visibilit√© et pr√©visualisez le rendu.</p>
                  </div>
                  <button type="button" class="rounded-xl border border-white/10 bg-white/5 px-4 py-2 text-xs font-semibold text-slate-200 transition hover:-translate-y-0.5 hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="addMenuItem">
                    Ajouter un lien
                  </button>
                </div>

                <div class="mt-6 space-y-4">
                  <template x-for="(item, index) in siteSeo.menu" :key="index">
                    <div class="flex flex-col gap-3 rounded-2xl border border-white/10 bg-white/8 p-4 shadow-inner md:flex-row md:items-center md:justify-between">
                      <div class="flex flex-1 flex-col gap-2 md:flex-row md:items-center md:gap-4">
                        <div class="flex items-center gap-2">
                          <button type="button" class="rounded-full border border-white/10 bg-white/5 p-2 text-slate-300 transition hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="moveMenuItem(index, -1)">
                            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                              <path d="M15 6l-6 6 6 6" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                          </button>
                          <button type="button" class="rounded-full border border-white/10 bg-white/5 p-2 text-slate-300 transition hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="moveMenuItem(index, 1)">
                            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                              <path d="M9 6l6 6-6 6" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                          </button>
                        </div>
                        <label class="flex-1 space-y-1 text-xs font-semibold uppercase tracking-wide text-slate-400">
                          Libell√©
                          <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="item.label">
                        </label>
                        <label class="flex-1 space-y-1 text-xs font-semibold uppercase tracking-wide text-slate-400">
                          Slug
                          <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="item.slug">
                        </label>
                      </div>
                      <div class="flex items-center gap-3">
                        <label class="flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-semibold text-slate-300">
                          <input type="checkbox" class="h-4 w-4 rounded border-white/20 bg-white/10 text-indigo-400 focus:ring-indigo-500" x-model="item.hidden">
                          Masquer
                        </label>
                        <button type="button" class="rounded-lg border border-rose-400/40 bg-rose-500/10 px-3 py-1 text-xs font-semibold text-rose-200 transition hover:bg-rose-500/20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-400" @click="removeMenuItem(index)">
                          Supprimer
                        </button>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </section>

            <section x-show="view === 'media'" x-transition.opacity class="space-y-6" aria-labelledby="media-title">
              <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                <div>
                  <h2 id="media-title" class="font-display text-xl font-semibold text-white">Biblioth√®que m√©dia</h2>
                  <p class="text-sm text-slate-400">T√©l√©chargez des visuels optimis√©s (compress√©s automatiquement en WebP).</p>
                </div>
                <div class="flex items-center gap-3">
                  <label for="media-upload" class="flex cursor-pointer items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold text-slate-200 transition hover:-translate-y-0.5 hover:bg-white/10 focus-within:outline focus-within:outline-2 focus-within:outline-offset-2 focus-within:outline-indigo-500">
                    <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M12 4v16m8-8H4" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Importer
                  </label>
                  <input id="media-upload" type="file" class="hidden" accept="image/*" @change="uploadMedia">
                </div>
              </div>

              <div class="grid gap-6 md:grid-cols-2 xl:grid-cols-3">
                <template x-for="item in media" :key="item.id">
                  <figure class="flex h-full flex-col overflow-hidden rounded-3xl border border-white/10 bg-white/5 shadow-lg">
                    <img :src="item.url" :alt="item.alt" class="h-48 w-full object-cover" loading="lazy" />
                    <figcaption class="flex flex-1 flex-col gap-3 px-5 py-4 text-sm text-slate-300">
                      <div>
                        <p class="font-medium text-white" x-text="item.alt"></p>
                        <p class="text-xs uppercase tracking-[0.18em] text-slate-500" x-text="item.filename"></p>
                      </div>
                      <div class="mt-auto flex items-center justify-between text-xs text-slate-500">
                        <span x-text="`${Math.round((item.bytes || 0)/1024)} Ko`"></span>
                        <button type="button" class="text-rose-300 transition hover:text-rose-200 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-rose-400" @click="deleteMedia(item.id)">Supprimer</button>
                      </div>
                    </figcaption>
                  </figure>
                </template>
              </div>
            </section>

            <section x-show="view === 'theme'" x-transition.opacity class="space-y-8" aria-labelledby="theme-title">
              <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                <div>
                  <h2 id="theme-title" class="font-display text-xl font-semibold text-white">Th√®me graphique</h2>
                  <p class="text-sm text-slate-400">D√©finissez les couleurs et polices globales de votre site statique.</p>
                </div>
                <button type="button" class="rounded-xl bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow shadow-lg transition hover:-translate-y-0.5 hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="saveTheme">
                  Enregistrer le th√®me
                </button>
              </div>
              <div class="grid gap-6 lg:grid-cols-2">
                <div class="space-y-4 rounded-3xl border border-white/10 bg-white/5 p-6">
                  <h3 class="text-sm font-semibold uppercase tracking-[0.2em] text-slate-500">Couleurs</h3>
                  <div class="grid gap-4 sm:grid-cols-2">
                    <label class="flex items-center gap-4 rounded-2xl border border-white/10 bg-white/5 p-4">
                      <input type="color" class="h-12 w-12 cursor-pointer appearance-none rounded-full border-0 bg-transparent p-0" x-model="theme.colors.primary">
                      <div>
                        <p class="text-sm font-semibold text-white">Primaire</p>
                        <p class="text-xs text-slate-400" x-text="theme.colors.primary"></p>
                      </div>
                    </label>
                    <label class="flex items-center gap-4 rounded-2xl border border-white/10 bg-white/5 p-4">
                      <input type="color" class="h-12 w-12 cursor-pointer appearance-none rounded-full border-0 bg-transparent p-0" x-model="theme.colors.secondary">
                      <div>
                        <p class="text-sm font-semibold text-white">Secondaire</p>
                        <p class="text-xs text-slate-400" x-text="theme.colors.secondary"></p>
                      </div>
                    </label>
                    <label class="flex items-center gap-4 rounded-2xl border border-white/10 bg-white/5 p-4">
                      <input type="color" class="h-12 w-12 cursor-pointer appearance-none rounded-full border-0 bg-transparent p-0" x-model="theme.colors.background">
                      <div>
                        <p class="text-sm font-semibold text-white">Fond</p>
                        <p class="text-xs text-slate-400" x-text="theme.colors.background"></p>
                      </div>
                    </label>
                    <label class="flex items-center gap-4 rounded-2xl border border-white/10 bg-white/5 p-4">
                      <input type="color" class="h-12 w-12 cursor-pointer appearance-none rounded-full border-0 bg-transparent p-0" x-model="theme.colors.text">
                      <div>
                        <p class="text-sm font-semibold text-white">Texte</p>
                        <p class="text-xs text-slate-400" x-text="theme.colors.text"></p>
                      </div>
                    </label>
                  </div>
                </div>

                <div class="space-y-4 rounded-3xl border border-white/10 bg-white/5 p-6">
                  <h3 class="text-sm font-semibold uppercase tracking-[0.2em] text-slate-500">Typographie & radius</h3>
                  <div class="grid gap-4 sm:grid-cols-2">
                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                      Police titres
                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="theme.fonts.display">
                    </label>
                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                      Police texte
                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="theme.fonts.body">
                    </label>
                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                      Rayon (petit)
                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="theme.radius.small">
                    </label>
                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                      Rayon (moyen)
                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="theme.radius.medium">
                    </label>
                    <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                      Rayon (grand)
                      <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="theme.radius.large">
                    </label>
                  </div>
                </div>
              </div>
            </section>

            <section x-show="view === 'layout'" x-transition.opacity class="space-y-6" aria-labelledby="layout-title">
              <div class="space-y-3">
                <h2 id="layout-title" class="font-display text-xl font-semibold text-white">Mise en page & presets</h2>
                <p class="text-sm text-slate-400">Ajustez l‚Äôatmosph√®re des sections : couleurs, marges, ombres et alignement. Les modifications s‚Äôappliquent imm√©diatement √† la page s√©lectionn√©e.</p>
              </div>
              <div class="grid gap-6 xl:grid-cols-[320px_1fr]">
                <aside class="space-y-4 rounded-3xl border border-white/10 bg-white/5 p-5">
                  <p class="text-xs uppercase tracking-[0.2em] text-slate-500">Sections de la page</p>
                  <template x-for="section in currentPage?.sections || []" :key="section.id">
                    <button type="button" class="w-full rounded-2xl border border-white/10 bg-white/0 px-4 py-3 text-left text-sm text-slate-200 transition hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" :class="layoutPanel.section === section.id ? 'border-indigo-500 bg-indigo-500/15 text-white shadow-lg' : ''" @click="selectLayoutSection(section.id)">
                      <span class="font-medium capitalize" x-text="section.type"></span>
                      <p class="text-xs text-slate-400" x-text="section.preset"></p>
                    </button>
                  </template>
                </aside>

                <div class="space-y-4">
                  <template x-for="group in layoutPanel.groups" :key="group.id">
                    <div class="overflow-hidden rounded-3xl border border-white/10 bg-white/5">
                      <button type="button" class="flex w-full items-center justify-between px-5 py-4 text-left text-sm font-semibold text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="toggleLayoutGroup(group.id)">
                        <span class="flex items-center gap-3">
                          <span class="grid h-9 w-9 place-items-center rounded-xl bg-white/10 text-indigo-400">
                            <span x-html="group.icon"></span>
                          </span>
                          <span x-text="group.label"></span>
                        </span>
                        <svg class="h-4 w-4 text-slate-400 transition" :class="layoutPanel.open[group.id] ? 'rotate-180' : ''" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                          <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                      </button>
                      <div x-show="layoutPanel.open[group.id]" x-transition.opacity>
                        <div class="space-y-4 border-t border-white/10 px-5 py-5">
                          <template x-for="option in group.options" :key="option.id">
                            <button type="button" class="flex w-full items-center justify-between rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-left text-sm transition hover:-translate-y-0.5 hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" :class="layoutPanel.selection[group.id] === option.id ? 'border-indigo-500 bg-indigo-500/15 text-white shadow-lg' : 'text-slate-300'" @click="applyLayoutOption(group.id, option.id)">
                              <span class="flex items-center gap-3">
                                <span class="grid h-9 w-9 place-items-center rounded-xl border border-white/10" :style="option.previewStyle" aria-hidden="true"></span>
                                <span>
                                  <span class="block font-semibold" x-text="option.label"></span>
                                  <span class="block text-xs text-slate-400" x-text="option.description"></span>
                                </span>
                              </span>
                              <svg x-show="layoutPanel.selection[group.id] === option.id" class="h-4 w-4 text-indigo-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M5 13l4 4L19 7" stroke-linecap="round" stroke-linejoin="round" />
                              </svg>
                            </button>
                          </template>
                        </div>
                      </div>
                    </div>
                  </template>
                </div>
              </div>
            </section>

            <section x-show="view === 'settings'" x-transition.opacity class="space-y-8" aria-labelledby="settings-title">
              <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
                <div>
                  <h2 id="settings-title" class="font-display text-xl font-semibold text-white">Param√®tres</h2>
                  <p class="text-sm text-slate-400">Gestion de l‚Äôacc√®s administrateur, mode de pr√©visualisation et automatisations.</p>
                </div>
                <button type="button" class="rounded-xl bg-indigo-500 px-4 py-2 text-sm font-semibold text-white shadow shadow-lg transition hover:-translate-y-0.5 hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="saveSettings">
                  Enregistrer
                </button>
              </div>

              <div class="grid gap-6 lg:grid-cols-2">
                <div class="space-y-4 rounded-3xl border border-white/10 bg-white/5 p-6">
                  <h3 class="text-sm font-semibold uppercase tracking-[0.2em] text-slate-500">Compte administrateur</h3>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Identifiant
                    <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.admin.username">
                  </label>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Nouveau mot de passe
                    <input type="password" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.admin.password" placeholder="Laisser vide pour conserver">
                  </label>
                </div>
                <div class="space-y-4 rounded-3xl border border-white/10 bg-white/5 p-6">
                  <h3 class="text-sm font-semibold uppercase tracking-[0.2em] text-slate-500">Pr√©visualisation & automation</h3>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Mode de pr√©visualisation
                    <select class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.preview.mode">
                      <option class="bg-slate-950 text-slate-200" value="modal">Modal</option>
                      <option class="bg-slate-950 text-slate-200" value="tab">Nouvel onglet</option>
                      <option class="bg-slate-950 text-slate-200" value="iframe">Zone int√©gr√©e</option>
                    </select>
                  </label>
                  <label class="flex items-center gap-3 rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-slate-300">
                    <input type="checkbox" class="h-5 w-5 rounded border-white/20 bg-white/10 text-indigo-400 focus:ring-indigo-500" x-model="settings.autoDeploy">
                    D√©ployer automatiquement apr√®s chaque g√©n√©ration
                  </label>
                  <button type="button" class="inline-flex items-center gap-2 rounded-xl border border-white/10 bg-white/0 px-4 py-2 text-sm font-semibold text-slate-200 transition hover:-translate-y-0.5 hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="createSite">
                    <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M12 5v14m7-7H5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Cr√©er un nouveau site
                  </button>
                </div>
                <div class="space-y-4 rounded-3xl border border-white/10 bg-white/5 p-6">
                  <h3 class="text-sm font-semibold uppercase tracking-[0.2em] text-slate-500">Apparence par d√©faut</h3>
                  <label class="flex items-center gap-3 rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-slate-300">
                    <input type="checkbox" class="h-5 w-5 rounded border-white/20 bg-white/10 text-indigo-400 focus:ring-indigo-500" :checked="settings.appearance.useSystem" @change="toggleAppearanceSystem($event.target.checked)">
                    Utiliser automatiquement le mode du syst√®me
                  </label>
                  <fieldset class="space-y-2">
                    <legend class="text-xs font-semibold uppercase tracking-wide text-slate-400">Modes disponibles</legend>
                    <template x-for="mode in themeModes" :key="mode.id">
                      <label class="flex items-center justify-between gap-3 rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm text-slate-300 transition hover:bg-white/10" :class="settings.appearance.mode === mode.id && !settings.appearance.useSystem ? 'border-indigo-400/60 bg-indigo-500/10 text-white' : ''">
                        <div class="flex items-center gap-3">
                          <input type="radio" class="h-4 w-4 text-indigo-400 focus:ring-indigo-500" name="site-appearance" :value="mode.id" :checked="settings.appearance.mode === mode.id" :disabled="settings.appearance.useSystem" @change="setAppearanceMode(mode.id)">
                          <span class="text-base" x-text="mode.icon"></span>
                          <span x-text="mode.label"></span>
                        </div>
                        <span x-show="settings.appearance.mode === mode.id && !settings.appearance.useSystem" class="text-xs font-semibold uppercase tracking-wide text-indigo-200">S√©lectionn√©</span>
                      </label>
                    </template>
                  </fieldset>
                  <p class="text-xs text-slate-400">Ce choix d√©finit l‚Äôapparence par d√©faut appliqu√©e aux nouveaux appareils. Chaque utilisateur peut toujours personnaliser sa vue via le s√©lecteur d‚Äôapparence.</p>
                </div>
              </div>
            </section>

            <section x-show="view === 'deploy'" x-transition.opacity class="space-y-6" aria-labelledby="deploy-title">
              <div class="space-y-2">
                <h2 id="deploy-title" class="font-display text-xl font-semibold text-white">D√©ploiement</h2>
                <p class="text-sm text-slate-400">Configurez la connexion FTP/SFTP et lancez la g√©n√©ration ou le d√©ploiement du site.</p>
              </div>
              <div class="rounded-3xl border border-white/10 bg-white/5 p-6 shadow-lg">
                <div class="grid gap-5 md:grid-cols-2">
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    H√¥te
                    <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.deployment.host">
                  </label>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Port
                    <input type="number" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model.number="settings.deployment.port">
                  </label>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Utilisateur
                    <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.deployment.username">
                  </label>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Mot de passe
                    <input type="password" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.deployment.password">
                  </label>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Chemin distant
                    <input type="text" class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.deployment.remotePath">
                  </label>
                  <label class="space-y-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">
                    Protocole
                    <select class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-900 placeholder:text-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/30 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100 dark:placeholder:text-slate-500 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:placeholder:text-contrastAccent/70" x-model="settings.deployment.protocol">
                      <option class="bg-slate-950 text-slate-200" value="sftp">SFTP</option>
                      <option class="bg-slate-950 text-slate-200" value="ftp">FTP</option>
                    </select>
                  </label>
                </div>
                <div class="mt-6 flex flex-wrap items-center gap-3">
                  <button type="button" class="rounded-xl border border-white/10 bg-white/0 px-4 py-2 text-sm font-semibold text-slate-200 transition hover:-translate-y-0.5 hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="triggerBuild">
                    G√©n√©rer le site
                  </button>
                  <button type="button" class="rounded-xl bg-indigo-500 px-5 py-2 text-sm font-semibold text-white shadow shadow-lg transition hover:-translate-y-0.5 hover:bg-indigo-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="triggerDeploy">
                    D√©ployer
                  </button>
                </div>
              </div>
            </section>
          </div>
        </main>
          <aside x-cloak x-show="$store.ui.showToolkit" x-transition.opacity.duration.200ms class="custom-scrollbar mt-6 flex-shrink-0 min-h-0 overflow-y-auto border-t border-slate-200 bg-white/90 px-6 py-6 dark:border-slate-800 dark:bg-slate-950/80 contrast:border-contrastAccent/50 contrast:bg-black/90 lg:mt-0 lg:max-w-[360px] lg:border-l lg:border-t-0 lg:max-h-[calc(100vh-120px)]" role="complementary" aria-label="Aper√ßu et design">
            <div class="flex h-full flex-col gap-6">
              <section x-show="$store.ui.showPreview" x-transition.opacity class="space-y-4">
                <div class="flex items-center justify-between">
                  <h2 class="text-sm font-semibold text-slate-600 dark:text-slate-200 contrast:text-contrastAccent">Mini preview</h2>
                  <div class="flex items-center gap-2">
                    <button type="button" class="flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-white text-base text-slate-600 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" :class="preview.viewport === 'desktop' ? 'border-indigo-500 bg-indigo-500 text-white dark:border-indigo-400 contrast:border-contrastAccent contrast:bg-contrastAccent contrast:text-contrastText' : ''" @click="setPreviewViewport('desktop')" :aria-pressed="(preview.viewport === 'desktop').toString()" :title="preview.viewport === 'desktop' ? 'Mode bureau actif' : 'Activer le mode bureau'">
                      <span aria-hidden="true">üñ•Ô∏è</span>
                    </button>
                    <button type="button" class="flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-white text-base text-slate-600 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" :class="preview.viewport === 'tablet' ? 'border-indigo-500 bg-indigo-500 text-white dark:border-indigo-400 contrast:border-contrastAccent contrast:bg-contrastAccent contrast:text-contrastText' : ''" @click="setPreviewViewport('tablet')" :aria-pressed="(preview.viewport === 'tablet').toString()" :title="preview.viewport === 'tablet' ? 'Mode tablette actif' : 'Activer le mode tablette'">
                      <span aria-hidden="true">üì±</span>
                    </button>
                    <button type="button" class="flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-white text-base text-slate-600 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" :class="preview.viewport === 'mobile' ? 'border-indigo-500 bg-indigo-500 text-white dark:border-indigo-400 contrast:border-contrastAccent contrast:bg-contrastAccent contrast:text-contrastText' : ''" @click="setPreviewViewport('mobile')" :aria-pressed="(preview.viewport === 'mobile').toString()" :title="preview.viewport === 'mobile' ? 'Mode mobile actif' : 'Activer le mode mobile'">
                      <span aria-hidden="true">üì≤</span>
                    </button>
                    <button type="button" class="flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-white text-base text-slate-600 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" @click="refreshPreviewFrame()" title="Rafra√Æchir la preview">
                      <span aria-hidden="true">üîÑ</span>
                    </button>
                    <button type="button" class="flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-white text-base text-slate-600 shadow-sm transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-200 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" @click="openPreview('tab')" title="Ouvrir la preview dans un onglet">
                      <span aria-hidden="true">üî≥</span>
                    </button>
                  </div>
                </div>
                <div class="rounded-3xl border border-slate-200 bg-slate-950/90 p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900 contrast:border-contrastAccent/40 contrast:bg-black">
                  <div class="relative h-[280px] min-h-[280px] overflow-hidden rounded-2xl border border-slate-800/80 bg-black/80">
                    <div class="absolute inset-0 flex items-start justify-center">
                      <iframe class="preview-frame h-[560px] w-[640px] origin-top transition-transform duration-200 ease-out" :class="{'scale-100': preview.viewport === 'desktop', 'scale-[0.75]': preview.viewport === 'tablet', 'scale-[0.5]': preview.viewport === 'mobile'}" :src="preview.url" title="Aper√ßu miniature du site" loading="lazy"></iframe>
                    </div>
                  </div>
                  <p class="mt-3 text-[11px] uppercase tracking-[0.2em] text-slate-400 dark:text-slate-500 contrast:text-contrastAccent">Preview auto √† jour</p>
                </div>
              </section>

              <section class="space-y-4">
                <div class="flex items-start justify-between gap-3">
                  <div>
                    <h2 class="text-sm font-semibold text-slate-600 dark:text-slate-200 contrast:text-contrastAccent">Design studio</h2>
                    <p class="text-xs text-slate-500 dark:text-slate-400 contrast:text-contrastText/80">Ajustez le bloc s√©lectionn√© pour un rendu instantan√©.</p>
                    <p class="mt-1 text-[11px] uppercase tracking-[0.24em] text-slate-400 dark:text-slate-500 contrast:text-contrastAccent" x-show="layoutPanel.section" x-text="activeLayoutSectionLabel()"></p>
                  </div>
                  <button type="button" class="flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-white text-slate-500 transition hover:-translate-y-0.5 hover:border-indigo-400 hover:text-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:border-slate-700 dark:bg-slate-900/80 dark:text-slate-300 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText contrast:hover:text-contrastAccent" @click="$store.ui.toggleToolkit()" :title="$store.ui.showToolkit ? 'Replier le studio' : 'Afficher le studio'">
                    <span aria-hidden="true">üß©</span>
                  </button>
                </div>
                <template x-if="!layoutPanel.section">
                  <p class="rounded-2xl border border-dashed border-slate-300 bg-white/80 px-4 py-6 text-center text-xs text-slate-500 shadow-sm dark:border-slate-700 dark:bg-slate-900/60 dark:text-slate-400 contrast:border-contrastAccent/60 contrast:bg-black contrast:text-contrastText/80">
                    S√©lectionnez un bloc dans la zone centrale pour personnaliser son apparence ici.
                  </p>
                </template>
                <template x-if="layoutPanel.section">
                  <div class="space-y-4">
                    <template x-for="group in layoutPanel.groups" :key="group.id">
                      <div class="rounded-2xl border border-slate-200 bg-white shadow-sm dark:border-slate-800 dark:bg-slate-900/60 contrast:border-contrastAccent/40 contrast:bg-black/85">
                        <button type="button" class="flex w-full items-center justify-between gap-3 px-4 py-3 text-sm font-semibold text-slate-600 transition hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:text-slate-200 dark:hover:bg-white/10 contrast:text-contrastText contrast:hover:bg-contrastAccent/15" @click="toggleLayoutGroup(group.id)">
                          <span class="flex items-center gap-2">
                            <span class="grid h-9 w-9 place-items-center rounded-xl bg-indigo-500/10 text-indigo-500 dark:text-indigo-300 contrast:bg-contrastAccent/20 contrast:text-contrastText" x-html="group.icon"></span>
                            <span x-text="group.label"></span>
                          </span>
                          <svg class="h-4 w-4 text-slate-400 transition" :class="layoutPanel.open[group.id] ? 'rotate-180' : ''" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round" />
                          </svg>
                        </button>
                        <div x-show="layoutPanel.open[group.id]" x-transition.opacity class="space-y-2 border-t border-slate-200 px-4 py-3 dark:border-slate-800 contrast:border-contrastAccent/40">
                          <template x-for="option in group.options" :key="option.id">
                            <button type="button" class="flex w-full items-start justify-between gap-3 rounded-xl px-3 py-2 text-left text-sm transition hover:bg-slate-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 dark:hover:bg-white/10 contrast:hover:bg-contrastAccent/15" :class="layoutPanel.selection[group.id] === option.id ? 'bg-indigo-50 text-indigo-600 shadow-sm dark:bg-indigo-500/20 dark:text-indigo-200 contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'text-slate-600 dark:text-slate-200 contrast:text-contrastText'" @click="applyLayoutOption(group.id, option.id)">
                              <div class="min-w-0">
                                <p class="font-medium" x-text="option.label"></p>
                                <p class="text-xs text-slate-500 dark:text-slate-400 contrast:text-contrastAccent/80" x-text="option.description"></p>
                              </div>
                              <span class="hidden h-10 w-12 flex-shrink-0 rounded-lg border border-slate-200 bg-white dark:border-slate-700 dark:bg-slate-900 contrast:border-contrastAccent/40 contrast:bg-black lg:flex" :style="option.previewStyle"></span>
                            </button>
                          </template>
                        </div>
                      </div>
                    </template>
                    <template x-if="isGroupSection(layoutPanel.section)">
                      <div class="rounded-2xl border border-slate-200 bg-white shadow-sm dark:border-slate-800 dark:bg-slate-900/60 contrast:border-contrastAccent/40 contrast:bg-black/85">
                        <div class="flex items-center justify-between px-4 py-3">
                          <span class="flex items-center gap-2 text-sm font-semibold text-slate-600 dark:text-slate-200 contrast:text-contrastText">
                            <span aria-hidden="true" class="text-lg">üß±</span>
                            Disposition
                          </span>
                          <span class="text-[11px] uppercase tracking-[0.24em] text-slate-400 dark:text-slate-500 contrast:text-contrastAccent/80" x-text="groupHasChildren(layoutPanel.section) ? 'Actif' : 'En attente'"></span>
                        </div>
                        <div class="space-y-4 border-t border-slate-200 px-4 py-4 text-sm dark:border-slate-800 contrast:border-contrastAccent/40">
                          <p class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">Type</p>
                          <div class="grid grid-cols-3 gap-2">
                            <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.type === 'block' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { type: 'block' })">
                              Bloc
                            </button>
                            <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.type === 'grid' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { type: 'grid' })">
                              Grille
                            </button>
                            <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.type === 'flex' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { type: 'flex' })">
                              Flex
                            </button>
                          </div>

                          <div class="space-y-2" x-show="selectedLayoutSection()?.style?.groupLayout?.type === 'grid'">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">Colonnes</p>
                            <div class="grid grid-cols-4 gap-2">
                              <template x-for="value in [1, 2, 3, 4]" :key="value">
                                <button type="button" class="rounded-xl border px-2 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.columns === value ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { columns: value })">
                                  <span x-text="value"></span>
                                </button>
                              </template>
                            </div>
                          </div>

                          <div class="space-y-2">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">Alignement horizontal</p>
                            <div class="grid grid-cols-3 gap-2">
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.horizontal === 'left' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { horizontal: 'left' })">
                                Gauche
                              </button>
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.horizontal === 'center' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { horizontal: 'center' })">
                                Centre
                              </button>
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.horizontal === 'right' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { horizontal: 'right' })">
                                Droite
                              </button>
                            </div>
                          </div>

                          <div class="space-y-2">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">Alignement vertical</p>
                            <div class="grid grid-cols-3 gap-2">
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.vertical === 'top' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { vertical: 'top' })">
                                Haut
                              </button>
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.vertical === 'center' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { vertical: 'center' })">
                                Centre
                              </button>
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.vertical === 'bottom' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { vertical: 'bottom' })">
                                Bas
                              </button>
                            </div>
                          </div>

                          <div class="space-y-2">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-300 contrast:text-contrastAccent">Espacement</p>
                            <div class="grid grid-cols-3 gap-2">
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.gap === 'small' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { gap: 'small' })">
                                Petit
                              </button>
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.gap === 'medium' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { gap: 'medium' })">
                                Moyen
                              </button>
                              <button type="button" class="rounded-xl border px-3 py-2 text-sm transition" :class="selectedLayoutSection()?.style?.groupLayout?.gap === 'large' ? 'border-indigo-500 bg-indigo-500/15 text-indigo-600 dark:text-indigo-200 contrast:border-contrastAccent contrast:bg-contrastAccent/20 contrast:text-contrastText' : 'border-slate-200 text-slate-500 dark:border-slate-700 dark:text-slate-300 contrast:border-contrastAccent/40 contrast:text-contrastText/80'" :disabled="!groupHasChildren(layoutPanel.section)" :aria-disabled="(!groupHasChildren(layoutPanel.section)).toString()" @click="updateGroupLayout(layoutPanel.section, { gap: 'large' })">
                                Grand
                              </button>
                            </div>
                          </div>

                          <p class="text-xs text-slate-500 dark:text-slate-400 contrast:text-contrastAccent/80" x-show="!groupHasChildren(layoutPanel.section)">
                            Ajoutez au moins un contenu dans ce groupe pour activer les options de disposition.
                          </p>
                        </div>
                      </div>
                    </template>
                  </div>
                </template>
              </section>
            </div>
          </aside>
        </div>
    </div>
  </template>

  <div x-show="preview.modalOpen" x-transition.opacity class="fixed inset-0 z-50 flex items-center justify-center bg-slate-950/70 backdrop-blur-md px-4 py-10" role="dialog" aria-modal="true" aria-label="Pr√©visualisation du site">
    <div class="relative w-full max-w-5xl rounded-3xl border border-white/10 bg-slate-900/80 p-4 shadow-2xl">
      <div class="flex items-center justify-between px-4 py-2">
        <p class="text-sm text-slate-300">Pr√©visualisation en direct</p>
        <div class="flex items-center gap-2">
          <button type="button" class="rounded-lg border border-white/10 bg-white/5 px-3 py-1 text-xs text-slate-200 transition hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="openPreview('tab')">
            Ouvrir dans un onglet
          </button>
          <button type="button" class="rounded-lg border border-white/10 bg-white/5 px-3 py-1 text-xs text-slate-200 transition hover:bg-white/10 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" @click="closePreviewModal">
            Fermer
          </button>
        </div>
      </div>
      <iframe class="preview-frame h-[70vh] w-full rounded-2xl border border-white/10 bg-white" :src="preview.url" title="Pr√©visualisation du site"></iframe>
    </div>
  </div>
</body>
</html>
