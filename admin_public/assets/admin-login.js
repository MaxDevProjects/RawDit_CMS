(()=>{document.addEventListener("DOMContentLoaded",()=>{let t=document.querySelector("form[data-login-form]"),n=document.querySelector("[data-login-status]");if(i(),!t)return;t.addEventListener("submit",async e=>{e.preventDefault(),n.textContent="";let a=t.querySelector('button[type="submit"]');a.disabled=!0;try{let o={username:t.elements.username.value,password:t.elements.password.value},s=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(s.ok){window.location.href="/admin/sites";return}let r=await s.json().catch(()=>({}));n.textContent=r.message||"Identifiants invalides."}catch{n.textContent="Erreur de connexion."}finally{a.disabled=!1}});async function i(){try{let e=await fetch("/api/auth/me",{credentials:"same-origin"});if(!e.ok)return;(await e.json().catch(()=>({}))).authenticated&&(window.location.href="/admin/sites")}catch(e){console.warn("[login] Impossible de v\xE9rifier la session active",e)}}});})();
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vY29yZS9zY3JpcHRzL2FkbWluLWxvZ2luLmpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtkYXRhLWxvZ2luLWZvcm1dJyk7XG4gIGNvbnN0IHN0YXR1cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWxvZ2luLXN0YXR1c10nKTtcblxuICByZWRpcmVjdElmQXV0aGVudGljYXRlZCgpO1xuXG4gIGlmICghZm9ybSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBzdGF0dXMudGV4dENvbnRlbnQgPSAnJztcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJyk7XG4gICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICB1c2VybmFtZTogZm9ybS5lbGVtZW50cy51c2VybmFtZS52YWx1ZSxcbiAgICAgICAgcGFzc3dvcmQ6IGZvcm0uZWxlbWVudHMucGFzc3dvcmQudmFsdWUsXG4gICAgICB9O1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9sb2dpbicsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSxcbiAgICAgIH0pO1xuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9hZG1pbi9zaXRlcyc7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG4gICAgICBzdGF0dXMudGV4dENvbnRlbnQgPSBib2R5Lm1lc3NhZ2UgfHwgJ0lkZW50aWZpYW50cyBpbnZhbGlkZXMuJztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHN0YXR1cy50ZXh0Q29udGVudCA9ICdFcnJldXIgZGUgY29ubmV4aW9uLic7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfSk7XG5cbiAgYXN5bmMgZnVuY3Rpb24gcmVkaXJlY3RJZkF1dGhlbnRpY2F0ZWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvYXV0aC9tZScsIHsgY3JlZGVudGlhbHM6ICdzYW1lLW9yaWdpbicgfSk7XG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHBheWxvYWQgPSBhd2FpdCByZXNwb25zZS5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG4gICAgICBpZiAocGF5bG9hZC5hdXRoZW50aWNhdGVkKSB7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9hZG1pbi9zaXRlcyc7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tsb2dpbl0gSW1wb3NzaWJsZSBkZSB2XHUwMEU5cmlmaWVyIGxhIHNlc3Npb24gYWN0aXZlJywgZXJyKTtcbiAgICB9XG4gIH1cbn0pO1xuIl0sCiAgIm1hcHBpbmdzIjogIk1BQUEsU0FBUyxpQkFBaUIsbUJBQW9CLElBQU0sQ0FDbEQsSUFBTUEsRUFBTyxTQUFTLGNBQWMsdUJBQXVCLEVBQ3JEQyxFQUFTLFNBQVMsY0FBYyxxQkFBcUIsRUFJM0QsR0FGQUMsRUFBd0IsRUFFcEIsQ0FBQ0YsRUFDSCxPQUdGQSxFQUFLLGlCQUFpQixTQUFVLE1BQU9HLEdBQVUsQ0FDL0NBLEVBQU0sZUFBZSxFQUNyQkYsRUFBTyxZQUFjLEdBQ3JCLElBQU1HLEVBQWVKLEVBQUssY0FBYyx1QkFBdUIsRUFDL0RJLEVBQWEsU0FBVyxHQUV4QixHQUFJLENBQ0YsSUFBTUMsRUFBVSxDQUNkLFNBQVVMLEVBQUssU0FBUyxTQUFTLE1BQ2pDLFNBQVVBLEVBQUssU0FBUyxTQUFTLEtBQ25DLEVBQ01NLEVBQVcsTUFBTSxNQUFNLGFBQWMsQ0FDekMsT0FBUSxPQUNSLFFBQVMsQ0FDUCxlQUFnQixrQkFDbEIsRUFDQSxLQUFNLEtBQUssVUFBVUQsQ0FBTyxDQUM5QixDQUFDLEVBQ0QsR0FBSUMsRUFBUyxHQUFJLENBQ2YsT0FBTyxTQUFTLEtBQU8sZUFDdkIsTUFDRixDQUNBLElBQU1DLEVBQU8sTUFBTUQsRUFBUyxLQUFLLEVBQUUsTUFBTSxLQUFPLENBQUMsRUFBRSxFQUNuREwsRUFBTyxZQUFjTSxFQUFLLFNBQVcseUJBQ3ZDLE1BQWMsQ0FDWk4sRUFBTyxZQUFjLHNCQUN2QixRQUFFLENBQ0FHLEVBQWEsU0FBVyxFQUMxQixDQUNGLENBQUMsRUFFRCxlQUFlRixHQUEwQixDQUN2QyxHQUFJLENBQ0YsSUFBTUksRUFBVyxNQUFNLE1BQU0sZUFBZ0IsQ0FBRSxZQUFhLGFBQWMsQ0FBQyxFQUMzRSxHQUFJLENBQUNBLEVBQVMsR0FDWixRQUVjLE1BQU1BLEVBQVMsS0FBSyxFQUFFLE1BQU0sS0FBTyxDQUFDLEVBQUUsR0FDMUMsZ0JBQ1YsT0FBTyxTQUFTLEtBQU8sZUFFM0IsT0FBU0UsRUFBSyxDQUNaLFFBQVEsS0FBSyxzREFBb0RBLENBQUcsQ0FDdEUsQ0FDRixDQUNGLENBQUMiLAogICJuYW1lcyI6IFsiZm9ybSIsICJzdGF0dXMiLCAicmVkaXJlY3RJZkF1dGhlbnRpY2F0ZWQiLCAiZXZlbnQiLCAic3VibWl0QnV0dG9uIiwgInBheWxvYWQiLCAicmVzcG9uc2UiLCAiYm9keSIsICJlcnIiXQp9Cg==
