(()=>{document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector("form[data-login-form]"),t=document.querySelector("[data-login-status]");e&&e.addEventListener("submit",async a=>{a.preventDefault(),t.textContent="";let n=e.querySelector('button[type="submit"]');n.disabled=!0;try{let o={username:e.elements.username.value,password:e.elements.password.value},s=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(s.ok){window.location.href="/admin/sites";return}let r=await s.json().catch(()=>({}));t.textContent=r.message||"Identifiants invalides."}catch{t.textContent="Erreur de connexion."}finally{n.disabled=!1}})});})();
