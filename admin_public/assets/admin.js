(()=>{document.addEventListener("DOMContentLoaded",()=>{console.log("[admin] Atelier charg\xE9");let ne=document.querySelector("[data-logout]");ne&&ne.addEventListener("click",async()=>{ne.disabled=!0;try{await fetch("/api/logout",{method:"POST",headers:{"Content-Type":"application/json"}})}catch(e){console.error("[admin] Impossible de se d\xE9connecter",e)}finally{window.location.href="/admin/index.html"}});let z=document.querySelector("[data-admin-sidebar]"),b=document.querySelector("[data-admin-sidebar-overlay]"),he=document.querySelectorAll("[data-admin-sidebar-toggle]"),He=document.querySelectorAll("[data-admin-sidebar-close]"),ae=document.body,W=!1,U=()=>{if(!z)return;if(window.matchMedia("(min-width: 1024px)").matches){z.classList.remove("hidden"),b==null||b.classList.add("hidden"),ae.classList.remove("overflow-hidden");return}W?(z.classList.remove("hidden"),b==null||b.classList.remove("hidden"),ae.classList.add("overflow-hidden")):(z.classList.add("hidden"),b==null||b.classList.add("hidden"),ae.classList.remove("overflow-hidden"))},ze=()=>{W=!0,U()},oe=()=>{W=!1,U()};z&&he.length>0&&(he.forEach(e=>{e.addEventListener("click",ze)}),He.forEach(e=>{e.addEventListener("click",oe)}),b==null||b.addEventListener("click",oe),window.addEventListener("resize",U),window.addEventListener("keydown",e=>{e.key==="Escape"&&W&&oe()}),U());let ve="clower:currentSite",be="clower:currentSiteName",d={slug:null,name:""};(()=>{try{d.slug=window.localStorage.getItem(ve),d.name=window.localStorage.getItem(be)||""}catch{d.slug=null,d.name=""}})();let re=document.querySelectorAll("[data-site-card]"),Ve=document.querySelectorAll("[data-site-select]"),V=document.querySelector("[data-current-site-name]"),Se=document.querySelector("[data-workspace-site-name]"),ye=document.querySelector("[data-workspace-back-name]"),I=document.querySelector("[data-workspace-back-modal]"),Re=document.querySelectorAll("[data-workspace-back]"),Oe=document.querySelectorAll("[data-workspace-back-cancel]"),ie=document.querySelector("[data-workspace-back-confirm]"),Ke=document.querySelectorAll("[data-workspace-tab]"),le=document.querySelector("[data-site-toast]"),we=document.querySelector("[data-site-toast-message]"),We=document.querySelectorAll("[data-site-create]"),f=document.querySelector("[data-site-modal]"),A=document.querySelector("[data-site-form]"),y=document.querySelector("[data-site-name]"),x=document.querySelector("[data-site-slug]"),p=document.querySelector("[data-site-slug-error]"),L=document.querySelector("[data-site-modal-error]"),Ue=document.querySelectorAll("[data-site-modal-cancel]"),j=document.querySelector("[data-site-modal-submit]"),C=Xe(),_=!1,J=null,ce=null,_e='a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])',xe=e=>{if(!f||f.classList.contains("hidden")||e.key!=="Tab")return;let n=Array.from(f.querySelectorAll(_e)).filter(w=>!w.hasAttribute("disabled")&&!w.getAttribute("aria-hidden"));if(n.length===0)return;let o=n[0],i=n[n.length-1];e.shiftKey?document.activeElement===o&&(e.preventDefault(),i.focus()):document.activeElement===i&&(e.preventDefault(),o.focus())},Le=e=>{!le||!we||(we.textContent=e,le.classList.remove("hidden"),ce&&clearTimeout(ce),ce=setTimeout(()=>{le.classList.add("hidden")},2500))},T=e=>e?e.startsWith("/")?e:`/${e}`:"",Y=e=>(e==null?void 0:e.replace(/^\//,""))||"",Z=(e,n)=>{let o=e?T(e):null;try{o&&(window.localStorage.setItem(ve,o),d.slug=o),typeof n=="string"&&n.length>0&&(window.localStorage.setItem(be,n),d.name=n)}catch{d.slug=o||d.slug,d.name=n||d.name}},Ce=e=>{V&&e&&(V.textContent=e),Se&&e&&(Se.textContent=e),ye&&e&&(ye.textContent=e)},de=e=>{Ke.forEach(n=>{let o=n.dataset.workspaceTab;if(!o)return;if(!e){n.href="#",n.classList.add("pointer-events-none","opacity-50","text-slate-400"),n.setAttribute("aria-disabled","true");return}let i=encodeURIComponent(Y(e));n.href=`/admin/site/${i}/${o}`,n.classList.remove("pointer-events-none","opacity-50","text-slate-400"),n.removeAttribute("aria-disabled")})},G=(e,n={})=>{if(!e)return;let o=T(e),i=n.siteName||d.name||(V==null?void 0:V.dataset.defaultSiteName)||"";re.forEach(l=>{let v=T(l.dataset.siteCard||"")===o,m=l.querySelector("[data-site-active-badge]");v?(l.classList.add("border-[#9C6BFF]","ring-2","ring-[#9C6BFF]","shadow-md"),l.classList.remove("border-slate-200"),m==null||m.classList.remove("hidden"),i=l.dataset.siteName||i):(l.classList.remove("border-[#9C6BFF]","ring-2","ring-[#9C6BFF]","shadow-md"),l.classList.add("border-slate-200"),m==null||m.classList.add("hidden"))}),n.persist!==!1&&Z(o,n.siteName||i);let w=n.siteName||i;Ce(w),de(o)},Je=async(e,n)=>{let o=T(e);try{let i=await fetch("/api/sites/select",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:o})});if(!i.ok){let m=await i.json().catch(()=>({}));Le(m.message||"Impossible de s\xE9lectionner ce site.");return}let w=await i.json().catch(()=>({})),l=T(w.slug||o),g=w.name||n;Z(l,g),G(l,{siteName:g,persist:!1});let v=encodeURIComponent(Y(l));window.location.href=`/admin/site/${v}/design`}catch(i){console.error("[admin] Impossible de s\xE9lectionner le site",i),Le("Erreur inattendue lors de la s\xE9lection.")}},Ye=async()=>{try{let e=await fetch("/api/sites/current",{credentials:"same-origin"});if(!e.ok){e.status===404&&C&&(window.location.href="/admin/sites");return}let n=await e.json(),o=T(n.slug);Z(o,n.name),G(o,{siteName:n.name,persist:!1})}catch(e){console.warn("[admin] Impossible de r\xE9cup\xE9rer le site actif",e)}};(()=>{if(d.slug){G(d.slug,{siteName:d.name,persist:!1});return}let e=document.querySelector('[data-site-card][data-site-default="true"]')||re[0];e&&G(e.dataset.siteCard,{siteName:e.dataset.siteName||"",persist:!1})})(),Ye(),C?de(C.slugValue):d.slug&&de(d.slug),Ve.forEach(e=>{e.addEventListener("click",()=>{if(e.disabled)return;let n=e.dataset.siteSelect,o=e.dataset.siteSelectName||"Ce site";n&&(e.disabled=!0,Je(n,o).finally(()=>{e.disabled=!1}))})});let Q=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),Ze=e=>{let n=Q(e||"");return n?`/${n}`:""},Ge=()=>{f&&(J=document.activeElement,f.classList.remove("hidden"),f.classList.add("flex"),_=!1,A==null||A.reset(),p&&(p.textContent=""),L&&(L.textContent=""),x&&y&&(x.value=Q(y.value)),document.addEventListener("keydown",xe),window.setTimeout(()=>{y==null||y.focus()},0))},X=()=>{f&&(f.classList.add("hidden"),f.classList.remove("flex"),document.removeEventListener("keydown",xe),_=!1,A==null||A.reset(),p&&(p.textContent=""),L&&(L.textContent=""),J==null||J.focus())};We.forEach(e=>{e.addEventListener("click",Ge)}),Ue.forEach(e=>{e.addEventListener("click",X)}),f==null||f.addEventListener("click",e=>{e.target===f&&X()}),y==null||y.addEventListener("input",()=>{x&&(!_||x.value.trim().length===0)&&(x.value=Q(y.value))}),x==null||x.addEventListener("input",()=>{_=!0,p&&(p.textContent="")});let Qe=()=>new Set(Array.from(re).map(e=>T(e.dataset.siteCard||"")));A==null||A.addEventListener("submit",async e=>{if(e.preventDefault(),!y||!x)return;let n=(y.value||"").trim(),o=x.value||"";o||(o=n);let i=Ze(o);if(!n||!i){p&&(p.textContent="Nom et slug sont requis.");return}if(Qe().has(i)){p&&(p.textContent="Ce slug est d\xE9j\xE0 utilis\xE9.");return}p&&(p.textContent=""),L&&(L.textContent=""),j&&(j.disabled=!0,j.textContent="Cr\xE9ation...");try{let l=await fetch("/api/sites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,slug:i})});if(!l.ok){let R=await l.json().catch(()=>({})),H=R.message||"Impossible de cr\xE9er ce site.";L&&(L.textContent=H),R.field==="slug"&&p&&(p.textContent=H);return}let g=await l.json(),v=T((g==null?void 0:g.slug)||i),m=(g==null?void 0:g.name)||n;Z(v,m),X();let N=encodeURIComponent(Y(v));window.location.href=`/admin/site/${N}/design`}catch(l){console.error("[admin] Impossible de cr\xE9er le site",l),L&&(L.textContent="Erreur inattendue. R\xE9essaie dans un instant.")}finally{j&&(j.disabled=!1,j.textContent="Cr\xE9er")}}),window.addEventListener("keydown",e=>{e.key==="Escape"&&(f&&!f.classList.contains("hidden")&&X(),I&&!I.classList.contains("hidden")&&ke())});function Xe(){let e=window.location.pathname.match(/^\/admin\/site\/([^/]+)(?:\/([^/]+))?/);return e?{slugPart:decodeURIComponent(e[1]),slugValue:T(decodeURIComponent(e[1])),section:e[2]||"design"}:null}function et(){if(!I){window.location.href="/admin/sites";return}I.classList.remove("hidden"),I.classList.add("flex")}function ke(){I&&(I.classList.add("hidden"),I.classList.remove("flex"))}Re.forEach(e=>{e.addEventListener("click",et)}),Oe.forEach(e=>{e.addEventListener("click",ke)}),ie==null||ie.addEventListener("click",()=>{window.location.href="/admin/sites"}),(C==null?void 0:C.section)==="design"&&tt(),C&&d.name&&Ce(d.name);function tt(){let e=document.querySelectorAll("[data-page-list]");if(e.length===0)return;let n=document.querySelector("[data-active-page-title]"),o=document.querySelector("[data-active-page-slug]"),i=document.querySelector("[data-page-preview-title]"),w=document.querySelector("[data-page-preview-description]"),l=document.querySelector("[data-page-preview-tags]"),g=document.querySelector("[data-preview-blocks]"),v=document.querySelector("[data-preview-blocks-empty]"),m=document.querySelector("[data-blocks-list]"),N=document.querySelector("[data-blocks-empty]"),R=document.querySelector("[data-block-count]"),H=document.querySelector("[data-block-detail]"),ue=document.querySelector("[data-block-detail-empty]"),Ee=document.querySelector("[data-block-detail-title]"),qe=document.querySelector("[data-block-detail-type]"),Ae=document.querySelector("[data-block-detail-description]"),ee=document.querySelector("[data-block-detail-props]"),$=document.querySelector("[data-block-detail-status]"),D=document.querySelector("[data-page-drawer]"),S=document.querySelector("[data-page-drawer-backdrop]"),st=document.querySelectorAll("[data-page-drawer-open]"),nt=document.querySelectorAll("[data-page-drawer-close]"),M=document.querySelector("[data-add-page-toggle]"),F=document.querySelector("[data-add-page-form]"),k=document.querySelector("[data-add-page-title]"),E=document.querySelector("[data-add-page-slug]"),me=document.querySelector("[data-add-page-cancel]"),q=document.querySelector("[data-add-page-error]"),Te=Y((C==null?void 0:C.slugValue)||d.slug||"default")||"default",te={pages:`clower:pages:${Te}`,active:`clower:activePage:${Te}`},h=(t,s,a,r,c,u=[])=>({id:t,label:s,type:a,status:r,description:c,props:u}),at=[{id:"home",title:"Accueil",slug:"/",description:"Hero immersif avec CTA, mise en avant des services et preuve sociale.",badges:["Hero","Services","CTA"],blocks:[h("home-hero","Hero principal","Hero","En ligne","Section immersive avec visuel plein \xE9cran et CTA principal.",[{label:"CTA",value:"Commencer"},{label:"Visuel",value:"Photo plein \xE9cran"}]),h("home-services","Services cl\xE9s","Sections","En ligne","Pr\xE9sentation synth\xE9tique des offres principales.",[{label:"Colonnes",value:"3"},{label:"Style",value:"Cards"}]),h("home-social","Preuves clients","Logos","En ligne","Logos et t\xE9moignages courts pour rassurer.",[{label:"Logos",value:"8"},{label:"Notes",value:"4.9/5"}])]},{id:"services",title:"Services",slug:"/services",description:"D\xE9tail des offres avec mise en page \xE9ditoriale et appels \xE0 l\u2019action.",badges:["Offres","Storytelling","CTA"],blocks:[h("services-intro","Introduction","Texte","En ligne","Paragraphe d\u2019ouverture qui pose la promesse.",[{label:"Longueur",value:"120 mots"}]),h("services-grid","Offres d\xE9taill\xE9es","Cards","En ligne","Cartes d\xE9taill\xE9es pour chaque service propos\xE9.",[{label:"Cartes",value:"4"},{label:"CTA",value:"D\xE9couvrir"}]),h("services-cases","\xC9tudes de cas","Portfolio","Brouillon","S\xE9lection de projets marquants.",[{label:"Projets",value:"3"}])]},{id:"realisations",title:"R\xE9alisations",slug:"/realisations",description:"S\xE9lection de projets r\xE9cents avec focus sur les r\xE9sultats.",badges:["Portfolio","Stats","Confiance"],blocks:[h("work-hero","Projets vedettes","Grid","En ligne","Mosa\xEFque des r\xE9alisations \xE0 mettre en avant.",[{label:"Layouts",value:"Masonry"}]),h("work-stats","Chiffres cl\xE9s","Stats","En ligne","Bloc m\xE9triques pour parler r\xE9sultats.",[{label:"KPI",value:"6"}]),h("work-reviews","Avis clients","Quotes","Brouillon","Citations extraites des entretiens clients.",[{label:"Avis",value:"2"}])]},{id:"contact",title:"Contact",slug:"/contact",description:"Formulaire de prise de contact simple et acc\xE8s aux coordonn\xE9es.",badges:["Formulaire","CTA","Infos"],blocks:[h("contact-header","Header court","Texte","En ligne","Intro concise pour inciter \xE0 prendre contact.",[{label:"Ton",value:"Direct"}]),h("contact-form","Formulaire","Form","En ligne","Formulaire de contact avec 4 champs.",[{label:"Champs",value:"Nom, Email, Projet, Budget"}]),h("contact-infos","Coordonn\xE9es","Infos","En ligne","Bloc avec adresse, t\xE9l\xE9phone et r\xE9seaux.",[{label:"Fuseau",value:"CET"}])]}],Be=t=>t.map(s=>({...s,badges:[...s.badges||[]],blocks:(s.blocks||[]).map(a=>({...a,props:(a.props||[]).map(r=>({...r}))}))})),ot=()=>{try{let t=window.localStorage.getItem(te.pages);if(t){let s=JSON.parse(t);if(Array.isArray(s))return Be(s)}}catch{}return Be(at)},rt=t=>{try{window.localStorage.setItem(te.pages,JSON.stringify(t))}catch{}},it=t=>{try{window.localStorage.setItem(te.active,t)}catch{}},lt=t=>{var s;try{let a=window.localStorage.getItem(te.active);if(a&&t.some(r=>r.id===a))return a}catch{}return((s=t[0])==null?void 0:s.id)||null},ct=t=>!t||t<=0?"0 bloc":t===1?"1 bloc":`${t} blocs`,Pe=t=>{if(!t||t==="/")return"/";let s=Q(t.replace(/^\//,""));return s?`/${s}`:"/"},Ie=(t="page",s="block")=>`${t}-${s}-${Date.now().toString(36)}-${Math.floor(Math.random()*1e3)}`,dt=(t,s)=>[h(Ie(t,"intro"),"Introduction","Texte","Brouillon",`Paragraphe introductif pour "${s}".`,[{label:"Longueur",value:"2 paragraphes"}]),h(Ie(t,"content"),"Zone de contenu","Section","Brouillon","Section principale \xE0 composer avec textes et visuels.",[{label:"Colonnes",value:"Auto"}])],ut=t=>{n&&(n.textContent=(t==null?void 0:t.title)||"Page"),o&&(o.textContent=(t==null?void 0:t.slug)||"/")},mt=t=>{t&&(i&&(i.textContent=t.title),w&&(w.textContent=t.description||"S\xE9lectionnez une page pour afficher son aper\xE7u."),l&&(l.innerHTML="",(t.badges&&t.badges.length>0?t.badges:["Aucun bloc"]).forEach(a=>{let r=document.createElement("span");r.className="rounded-full bg-slate-100 px-3 py-1",r.textContent=a,l.appendChild(r)})))},Ne=t=>{if(!g)return;g.innerHTML="";let s=(t==null?void 0:t.blocks)||[];if(!s.length){v==null||v.classList.remove("hidden");return}v==null||v.classList.add("hidden"),s.forEach((a,r)=>{let c=a.id===K,u=document.createElement("div");u.dataset.previewBlockId=a.id,u.className=["rounded-2xl border bg-white/80 px-4 py-3 shadow-sm transition",c?"border-[#9C6BFF]/50 ring-2 ring-[#9C6BFF]/40":"border-slate-200 hover:border-[#9C6BFF]/40"].join(" "),u.innerHTML=`
          <p class="text-[11px] uppercase tracking-wide text-slate-400">Bloc ${r+1}</p>
          <p class="text-sm font-semibold text-slate-900">${a.label}</p>
          <p class="text-xs text-slate-500">${a.type} \u2022 ${a.status}</p>
        `,g.appendChild(u)})},ft=t=>{switch((t||"").toLowerCase()){case"en ligne":return"bg-emerald-50 text-emerald-700";case"brouillon":return"bg-amber-50 text-amber-700";default:return"bg-slate-100 text-slate-600"}},Fe=t=>{if(!(!H||!ue)){if(!t){H.classList.add("hidden"),ue.classList.remove("hidden"),$==null||$.classList.add("hidden");return}if(H.classList.remove("hidden"),ue.classList.add("hidden"),Ee&&(Ee.textContent=t.label),qe&&(qe.textContent=t.type),Ae&&(Ae.textContent=t.description||"Aucune description pour ce bloc."),ee)if(ee.innerHTML="",t.props&&t.props.length>0)t.props.forEach(s=>{let a=document.createElement("div");a.className="flex items-center justify-between gap-3 rounded-xl border border-slate-200 px-3 py-2 text-sm",a.innerHTML=`
              <span class="text-xs uppercase tracking-wide text-slate-500">${s.label}</span>
              <span class="font-semibold text-slate-900">${s.value}</span>
            `,ee.appendChild(a)});else{let s=document.createElement("div");s.className="rounded-xl border border-dashed border-slate-200 px-3 py-2 text-sm text-slate-500",s.textContent="Aucune propri\xE9t\xE9 d\xE9clar\xE9e.",ee.appendChild(s)}$&&($.textContent=t.status,$.className=`rounded-full px-3 py-1 text-xs font-semibold ${ft(t.status)}`,$.classList.remove("hidden"))}},$e=t=>{if(!m)return;m.innerHTML="";let s=(t==null?void 0:t.blocks)||[];if(R&&(R.textContent=ct(s.length)),s.length===0){m.classList.add("hidden"),N==null||N.classList.remove("hidden");return}m.classList.remove("hidden"),N==null||N.classList.add("hidden"),s.forEach(a=>{let r=a.id===K,c=document.createElement("button");c.type="button",c.dataset.blockId=a.id,c.setAttribute("role","option"),c.setAttribute("aria-selected",r?"true":"false"),c.className=["relative w-full rounded-xl border px-4 py-2 text-left transition focus:outline-none focus:ring-2 focus:ring-[#9C6BFF]/40",r?"bg-slate-100 border-[#9C6BFF]/40 text-slate-900 shadow-sm":"border-transparent text-slate-700 hover:bg-slate-50"].join(" "),c.innerHTML=`
          <span class="${r?"":"hidden"} absolute inset-y-2 left-0 w-1 rounded-full bg-[#9C6BFF]"></span>
          <div class="flex items-center gap-2 text-xs">
            <span class="rounded-full bg-slate-100 px-2 py-0.5 font-semibold text-slate-600">${a.type}</span>
            <span class="text-slate-400">${a.status}</span>
          </div>
          <p class="mt-1 text-sm font-semibold">${a.label}</p>
        `,c.addEventListener("click",()=>{gt(a.id)}),m.appendChild(c)})},De=(t,s)=>{e.forEach(a=>{a.innerHTML="",t.forEach(r=>{let c=document.createElement("li"),u=document.createElement("button");u.type="button",u.dataset.pageId=r.id,u.className=["w-full flex items-center justify-between gap-3 px-3 py-2 text-left transition",s===r.id?"bg-[#9C6BFF]/10 text-slate-900 border border-[#9C6BFF]/40 rounded-xl shadow-sm":"text-slate-700 hover:bg-slate-50 rounded-xl"].join(" "),s===r.id?u.setAttribute("aria-current","page"):u.removeAttribute("aria-current"),u.innerHTML=`
            <div class="flex items-center gap-3">
              <span class="flex h-9 w-9 items-center justify-center rounded-xl border border-slate-200 bg-white text-slate-500">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M6.5 4.5h7l4 4v11a1 1 0 0 1-1 1h-10a1 1 0 0 1-1-1v-14a1 1 0 0 1 1-1Z" stroke="currentColor" stroke-width="1.4" stroke-linejoin="round"/>
                  <path d="M13.5 4.5v4a1 1 0 0 0 1 1h3" stroke="currentColor" stroke-width="1.4"/>
                </svg>
              </span>
              <div class="flex flex-col">
                <span class="text-sm font-semibold">${r.title}</span>
                <span class="text-xs text-slate-500">${r.slug}</span>
              </div>
            </div>
          `,u.addEventListener("click",()=>{fe(r.id),pe()||ge()}),c.appendChild(u),a.appendChild(c)})})},pt=()=>!P||!Array.isArray(P.blocks)?null:P.blocks.find(t=>t.id===K)||null,gt=t=>{if(!P)return;let s=P.blocks.find(a=>a.id===t)||P.blocks[0]||null;K=(s==null?void 0:s.id)||null,$e(P),Fe(s),Ne(P)},fe=t=>{var a,r;let s=B.find(c=>c.id===t)||B[0];P=s||null,O=(s==null?void 0:s.id)||null,K=((r=(a=s==null?void 0:s.blocks)==null?void 0:a[0])==null?void 0:r.id)||null,it(O||""),De(B,O),ut(s),mt(s),$e(s),Fe(pt()),Ne(s)},pe=()=>window.matchMedia("(min-width: 1024px)").matches,Me=()=>{D&&(pe()?(D.classList.add("is-open"),S==null||S.classList.add("hidden"),document.body.classList.remove("overflow-hidden")):D.classList.remove("is-open"))},ht=()=>{!D||pe()||(D.classList.add("is-open"),S==null||S.classList.remove("hidden"),document.body.classList.add("overflow-hidden"))},ge=()=>{D&&(D.classList.remove("is-open"),S==null||S.classList.add("hidden"),document.body.classList.remove("overflow-hidden"))},vt=()=>{!F||!M||(F.classList.remove("hidden"),M.classList.add("hidden"),q&&(q.textContent=""),se=!1,k&&(k.value="",k.focus()),E&&(E.value=""))},je=()=>{!F||!M||(F.classList.add("hidden"),M.classList.remove("hidden"),q&&(q.textContent=""),se=!1,F.reset())},bt=()=>{!k||!E||se&&E.value.trim().length>0||(E.value=Pe(k.value))},B=ot(),O=lt(B),se=!1,P=null,K=null;De(B,O),fe(O),Me(),st.forEach(t=>{t.addEventListener("click",ht)}),nt.forEach(t=>{t.addEventListener("click",ge)}),S==null||S.addEventListener("click",ge),window.addEventListener("resize",Me),M==null||M.addEventListener("click",vt),me==null||me.addEventListener("click",je),k==null||k.addEventListener("input",bt),E==null||E.addEventListener("input",()=>{q&&(q.textContent=""),se=!0}),F==null||F.addEventListener("submit",t=>{if(t.preventDefault(),!k||!E)return;let s=k.value.trim(),a=Pe(E.value.trim()||s);if(!s||!a){q&&(q.textContent="Titre et slug sont requis.");return}if(B.some(u=>u.slug===a)){q&&(q.textContent="Ce slug est d\xE9j\xE0 utilis\xE9.");return}let r=`page-${Date.now().toString(36)}`,c={id:r,title:s,slug:a,description:`Nouvelle page "${s}" pr\xEAte \xE0 \xEAtre maquett\xE9e.`,badges:["Layout","Texte"],blocks:dt(r,s)};B=[...B,c],rt(B),je(),fe(c.id)})}});})();
